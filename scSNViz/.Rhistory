output_dir = output_dir,
include_histograms = TRUE,
dimensionality_reduction = "umap",
include_cell_types = TRUE,
include_copykat = FALSE,
slingshot = TRUE,
color_scale = "YlOrRd",
cell_border = 0,
save_each_plot = TRUE)
# generate individual snv plots
ind_snv_plots <- individual_snv_plots(seurat_object = processed_data$SeuratObject,
processed_snv = processed_data$ProcessedSNV,
output_dir = output_dir,
slingshot = TRUE,
save_each_plot = TRUE,
dimensionality_reduction = "UMAP",
dynamic_cell_size = FALSE)
# generate a report without individual snv plots
#generate_report(plot_object = plots,
#                output_dir = output_dir)
# generate a report with individual snv plots
generate_report(plot_object = plots,
ind_snv_object = ind_snv_plots,
hide_ind_plots = FALSE,
output_dir = output_dir)
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
library(sceSNViz)
#rds_file_path <- system.file("input", "sample_Seurat_object.rds", package = "sceSNViz")
#snv_file_path <- system.file("input", "sample_SNVs.txt", package = "sceSNViz")
#if above does not work:
rds_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_Seurat_object.rds"
snv_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_SNVs.txt"
output_dir = "output"    # or output directory of your choice
# preprocessing the snv data
processed_data <- preprocess_snv_data(rds_file = rds_file_path,
snv_file = snv_file_path,
dimensionality_reduction = "UMAP",
th_vars = 0,
th_reads = 0,
enable_sctype = TRUE,
tissue_type = "Immunesystem",
generate_statistics = TRUE,
output_dir = output_dir)
# generate the different 3d dimensionality reduction plots
plots <- plot_snv_data(seurat_object = processed_data$SeuratObject,
processed_data$ProcessedSNV,
processed_data$AggregatedSNV,
processed_data$PlotData,
output_dir = output_dir,
include_histograms = TRUE,
dimensionality_reduction = "umap",
include_cell_types = TRUE,
include_copykat = FALSE,
slingshot = TRUE,
color_scale = "YlOrRd",
cell_border = 0,
save_each_plot = TRUE)
# generate individual snv plots
ind_snv_plots <- individual_snv_plots(seurat_object = processed_data$SeuratObject,
processed_snv = processed_data$ProcessedSNV,
output_dir = output_dir,
slingshot = TRUE,
save_each_plot = TRUE,
dimensionality_reduction = "UMAP",
dynamic_cell_size = FALSE)
# generate a report without individual snv plots
#generate_report(plot_object = plots,
#                output_dir = output_dir)
# generate a report with individual snv plots
generate_report(plot_object = plots,
ind_snv_object = ind_snv_plots,
hide_ind_plots = FALSE,
output_dir = output_dir)
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
library(sceSNViz)
#rds_file_path <- system.file("input", "sample_Seurat_object.rds", package = "sceSNViz")
#snv_file_path <- system.file("input", "sample_SNVs.txt", package = "sceSNViz")
#if above does not work:
rds_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_Seurat_object.rds"
snv_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_SNVs.txt"
output_dir = "output"    # or output directory of your choice
# preprocessing the snv data
processed_data <- preprocess_snv_data(rds_file = rds_file_path,
snv_file = snv_file_path,
dimensionality_reduction = "UMAP",
th_vars = 0,
th_reads = 0,
enable_sctype = TRUE,
tissue_type = "Immunesystem",
generate_statistics = TRUE,
output_dir = output_dir)
# generate the different 3d dimensionality reduction plots
plots <- plot_snv_data(seurat_object = processed_data$SeuratObject,
processed_data$ProcessedSNV,
processed_data$AggregatedSNV,
processed_data$PlotData,
output_dir = output_dir,
include_histograms = TRUE,
dimensionality_reduction = "umap",
include_cell_types = TRUE,
include_copykat = FALSE,
slingshot = TRUE,
color_scale = "YlOrRd",
cell_border = 0,
save_each_plot = TRUE)
# generate individual snv plots
ind_snv_plots <- individual_snv_plots(seurat_object = processed_data$SeuratObject,
processed_snv = processed_data$ProcessedSNV,
output_dir = output_dir,
slingshot = TRUE,
save_each_plot = TRUE,
dimensionality_reduction = "UMAP",
dynamic_cell_size = FALSE)
# generate a report without individual snv plots
#generate_report(plot_object = plots,
#                output_dir = output_dir)
# generate a report with individual snv plots
generate_report(plot_object = plots,
ind_snv_object = ind_snv_plots,
hide_ind_plots = FALSE,
output_dir = output_dir)
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
library(sceSNViz)
#rds_file_path <- system.file("input", "sample_Seurat_object.rds", package = "sceSNViz")
#snv_file_path <- system.file("input", "sample_SNVs.txt", package = "sceSNViz")
#if above does not work:
rds_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_Seurat_object.rds"
snv_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_SNVs.txt"
output_dir = "output"    # or output directory of your choice
# preprocessing the snv data
processed_data <- preprocess_snv_data(rds_file = rds_file_path,
snv_file = snv_file_path,
dimensionality_reduction = "UMAP",
th_vars = 0,
th_reads = 0,
enable_sctype = TRUE,
tissue_type = "Immunesystem",
generate_statistics = TRUE,
output_dir = output_dir)
# generate the different 3d dimensionality reduction plots
plots <- plot_snv_data(seurat_object = processed_data$SeuratObject,
processed_data$ProcessedSNV,
processed_data$AggregatedSNV,
processed_data$PlotData,
output_dir = output_dir,
include_histograms = TRUE,
dimensionality_reduction = "umap",
include_cell_types = TRUE,
include_copykat = FALSE,
slingshot = TRUE,
color_scale = "YlOrRd",
cell_border = 0,
save_each_plot = TRUE)
# generate individual snv plots
ind_snv_plots <- individual_snv_plots(seurat_object = processed_data$SeuratObject,
processed_snv = processed_data$ProcessedSNV,
output_dir = output_dir,
slingshot = TRUE,
save_each_plot = TRUE,
dimensionality_reduction = "UMAP",
dynamic_cell_size = FALSE)
# generate a report without individual snv plots
#generate_report(plot_object = plots,
#                output_dir = output_dir)
# generate a report with individual snv plots
generate_report(plot_object = plots,
ind_snv_object = ind_snv_plots,
hide_ind_plots = FALSE,
output_dir = output_dir)
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
library(sceSNViz)
#rds_file_path <- system.file("input", "sample_Seurat_object.rds", package = "sceSNViz")
#snv_file_path <- system.file("input", "sample_SNVs.txt", package = "sceSNViz")
#if above does not work:
rds_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_Seurat_object.rds"
snv_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_SNVs.txt"
output_dir = "output"    # or output directory of your choice
# preprocessing the snv data
processed_data <- preprocess_snv_data(rds_file = rds_file_path,
snv_file = snv_file_path,
dimensionality_reduction = "UMAP",
th_vars = 0,
th_reads = 0,
enable_sctype = TRUE,
tissue_type = "Immunesystem",
generate_statistics = TRUE,
output_dir = output_dir)
# generate the different 3d dimensionality reduction plots
plots <- plot_snv_data(seurat_object = processed_data$SeuratObject,
processed_data$ProcessedSNV,
processed_data$AggregatedSNV,
processed_data$PlotData,
output_dir = output_dir,
include_histograms = TRUE,
dimensionality_reduction = "umap",
include_cell_types = TRUE,
include_copykat = FALSE,
slingshot = TRUE,
color_scale = "YlOrRd",
cell_border = 0,
save_each_plot = TRUE)
# generate individual snv plots
ind_snv_plots <- individual_snv_plots(seurat_object = processed_data$SeuratObject,
processed_snv = processed_data$ProcessedSNV,
output_dir = output_dir,
slingshot = TRUE,
save_each_plot = TRUE,
dimensionality_reduction = "UMAP",
dynamic_cell_size = FALSE)
# generate a report without individual snv plots
#generate_report(plot_object = plots,
#                output_dir = output_dir)
# generate a report with individual snv plots
generate_report(plot_object = plots,
ind_snv_object = ind_snv_plots,
hide_ind_plots = FALSE,
output_dir = output_dir)
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
library(sceSNViz)
#rds_file_path <- system.file("input", "sample_Seurat_object.rds", package = "sceSNViz")
#snv_file_path <- system.file("input", "sample_SNVs.txt", package = "sceSNViz")
#if above does not work:
rds_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_Seurat_object.rds"
snv_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_SNVs.txt"
output_dir = "output"    # or output directory of your choice
# preprocessing the snv data
processed_data <- preprocess_snv_data(rds_file = rds_file_path,
snv_file = snv_file_path,
dimensionality_reduction = "UMAP",
th_vars = 0,
th_reads = 0,
enable_sctype = TRUE,
tissue_type = "Immunesystem",
generate_statistics = TRUE,
output_dir = output_dir)
devtools::document()
roxygen2::roxygenise()
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
library(sceSNViz)
#rds_file_path <- system.file("input", "sample_Seurat_object.rds", package = "sceSNViz")
#snv_file_path <- system.file("input", "sample_SNVs.txt", package = "sceSNViz")
#if above does not work:
rds_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_Seurat_object.rds"
snv_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_SNVs.txt"
output_dir = "output"    # or output directory of your choice
# preprocessing the snv data
processed_data <- preprocess_snv_data(rds_file = rds_file_path,
snv_file = snv_file_path,
dimensionality_reduction = "UMAP",
th_vars = 0,
th_reads = 0,
enable_sctype = TRUE,
tissue_type = "Immunesystem",
generate_statistics = TRUE,
output_dir = output_dir)
# generate the different 3d dimensionality reduction plots
plots <- plot_snv_data(seurat_object = processed_data$SeuratObject,
processed_data$ProcessedSNV,
processed_data$AggregatedSNV,
processed_data$PlotData,
output_dir = output_dir,
include_histograms = TRUE,
dimensionality_reduction = "umap",
include_cell_types = TRUE,
include_copykat = FALSE,
slingshot = TRUE,
color_scale = "YlOrRd",
cell_border = 0,
save_each_plot = TRUE)
# generate individual snv plots
ind_snv_plots <- individual_snv_plots(seurat_object = processed_data$SeuratObject,
processed_snv = processed_data$ProcessedSNV,
output_dir = output_dir,
slingshot = TRUE,
save_each_plot = TRUE,
dimensionality_reduction = "UMAP",
dynamic_cell_size = FALSE)
# generate a report without individual snv plots
#generate_report(plot_object = plots,
#                output_dir = output_dir)
# generate a report with individual snv plots
generate_report(plot_object = plots,
ind_snv_object = ind_snv_plots,
hide_ind_plots = FALSE,
output_dir = output_dir)
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
library(sceSNViz)
#rds_file_path <- system.file("input", "sample_Seurat_object.rds", package = "sceSNViz")
#snv_file_path <- system.file("input", "sample_SNVs.txt", package = "sceSNViz")
#if above does not work:
rds_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_Seurat_object.rds"
snv_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_SNVs.txt"
output_dir = "output"    # or output directory of your choice
# preprocessing the snv data
processed_data <- preprocess_snv_data(rds_file = rds_file_path,
snv_file = snv_file_path,
dimensionality_reduction = "UMAP",
th_vars = 0,
th_reads = 0,
enable_sctype = TRUE,
tissue_type = "Immunesystem",
generate_statistics = TRUE,
output_dir = output_dir)
# generate the different 3d dimensionality reduction plots
plots <- plot_snv_data(seurat_object = processed_data$SeuratObject,
processed_data$ProcessedSNV,
processed_data$AggregatedSNV,
processed_data$PlotData,
output_dir = output_dir,
include_histograms = TRUE,
dimensionality_reduction = "umap",
include_cell_types = TRUE,
include_copykat = FALSE,
slingshot = TRUE,
color_scale = "YlOrRd",
cell_border = 0,
save_each_plot = TRUE)
# generate individual snv plots
ind_snv_plots <- individual_snv_plots(seurat_object = processed_data$SeuratObject,
processed_snv = processed_data$ProcessedSNV,
output_dir = output_dir,
slingshot = TRUE,
save_each_plot = TRUE,
dimensionality_reduction = "UMAP",
dynamic_cell_size = FALSE)
# generate a report without individual snv plots
#generate_report(plot_object = plots,
#                output_dir = output_dir)
# generate a report with individual snv plots
generate_report(plot_object = plots,
ind_snv_object = ind_snv_plots,
hide_ind_plots = FALSE,
output_dir = output_dir)
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
library(sceSNViz)
#rds_file_path <- system.file("input", "sample_Seurat_object.rds", package = "sceSNViz")
#snv_file_path <- system.file("input", "sample_SNVs.txt", package = "sceSNViz")
#if above does not work:
rds_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_Seurat_object.rds"
snv_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_SNVs.txt"
output_dir = "output"    # or output directory of your choice
# preprocessing the snv data
processed_data <- preprocess_snv_data(rds_file = rds_file_path,
snv_file = snv_file_path,
dimensionality_reduction = "UMAP",
th_vars = 0,
th_reads = 0,
enable_sctype = TRUE,
tissue_type = "Immunesystem",
generate_statistics = TRUE,
output_dir = output_dir)
# generate the different 3d dimensionality reduction plots
plots <- plot_snv_data(seurat_object = processed_data$SeuratObject,
processed_data$ProcessedSNV,
processed_data$AggregatedSNV,
processed_data$PlotData,
output_dir = output_dir,
include_histograms = TRUE,
dimensionality_reduction = "umap",
include_cell_types = TRUE,
include_copykat = FALSE,
slingshot = TRUE,
color_scale = "YlOrRd",
cell_border = 0,
save_each_plot = TRUE)
# generate individual snv plots
ind_snv_plots <- individual_snv_plots(seurat_object = processed_data$SeuratObject,
processed_snv = processed_data$ProcessedSNV,
output_dir = output_dir,
slingshot = TRUE,
save_each_plot = TRUE,
dimensionality_reduction = "UMAP",
dynamic_cell_size = FALSE)
# generate a report without individual snv plots
#generate_report(plot_object = plots,
#                output_dir = output_dir)
# generate a report with individual snv plots
generate_report(plot_object = plots,
ind_snv_object = ind_snv_plots,
hide_ind_plots = FALSE,
output_dir = output_dir)
devtools::document()
roxygen2::roxygenise()
devtools::build()
devtools::install()
devtools::check()
library(sceSNViz)
#rds_file_path <- system.file("input", "sample_Seurat_object.rds", package = "sceSNViz")
#snv_file_path <- system.file("input", "sample_SNVs.txt", package = "sceSNViz")
#if above does not work:
rds_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_Seurat_object.rds"
snv_file_path <- "C:\\Users\\tusha\\Downloads\\scSNViz_0930\\sample_SNVs.txt"
output_dir = "output"    # or output directory of your choice
# preprocessing the snv data
processed_data <- preprocess_snv_data(rds_file = rds_file_path,
snv_file = snv_file_path,
dimensionality_reduction = "UMAP",
th_vars = 0,
th_reads = 0,
enable_sctype = TRUE,
tissue_type = "Immunesystem",
generate_statistics = TRUE,
output_dir = output_dir)
# generate the different 3d dimensionality reduction plots
plots <- plot_snv_data(seurat_object = processed_data$SeuratObject,
processed_data$ProcessedSNV,
processed_data$AggregatedSNV,
processed_data$PlotData,
output_dir = output_dir,
include_histograms = TRUE,
dimensionality_reduction = "umap",
include_cell_types = TRUE,
include_copykat = FALSE,
slingshot = TRUE,
color_scale = "YlOrRd",
cell_border = 0,
save_each_plot = TRUE)
# generate individual snv plots
ind_snv_plots <- individual_snv_plots(seurat_object = processed_data$SeuratObject,
processed_snv = processed_data$ProcessedSNV,
output_dir = output_dir,
slingshot = TRUE,
save_each_plot = TRUE,
dimensionality_reduction = "UMAP",
dynamic_cell_size = FALSE)
# generate a report without individual snv plots
#generate_report(plot_object = plots,
#                output_dir = output_dir)
# generate a report with individual snv plots
generate_report(plot_object = plots,
ind_snv_object = ind_snv_plots,
hide_ind_plots = FALSE,
output_dir = output_dir)
library(scSNViz)
detach("package:sceSNViz", unload = TRUE)
remove.packages("scSNViz")
devtools::document()
roxygen2::roxygenise()
\
devtools::load_all()
devtools::build()
load.lib<-c("scSNViz","SingleCellExperiment", "stringr", "HGNChelper", "Matrix", "umap", "Rtsne", "Seurat", "sctransform", "ggplot2", "readr",
"dplyr", "plotly", "htmlwidgets", "htmltools", "jsonlite", "glmGamPoi", "slingshot", "copykat", "listviewer","openxlsx") # the installation of ("glmGamPoi") is highly recommended
install.lib <- load.lib[!load.lib %in% installed.packages()]
for(lib in install.lib) install.packages(lib,dependencies=TRUE)
sapply(load.lib,require,character=TRUE)
snv_file <- "sample1_SNVs.tsv"
output_dir = "output"    # or output directory of your choice
srt <- readRDS("/input/sample1_Seurat_object.rds")
srt <- readRDS('input/sample1_Seurat_object.rds')
# define the percentage of counts per cell that originate from mitochondrial genes
srt[["percent.mt"]] <- PercentageFeatureSet(srt, pattern = "^MT-") # this is for Homo sapiens. If the organism is Mus musculus, then: pattern = '^mt-'
# plot the number of features (or genes) per cell, the number of counts per cell and the percent.mt per cell
VlnPlot(srt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3) # As described in Seurat introductory Vignettes
# filter the Seurat object based on the violin plot
srt <- subset(srt, subset = nFeature_RNA > 1000 & nFeature_RNA < 7500 & nCount_RNA <50000 & percent.mt < 15) # Modify numbers appropriate to your violin plot
VlnPlot(srt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3) # As described in Seurat introductory Vignettes
srt
# define the percentage of counts per cell that originate from mitochondrial genes
srt[["percent.mt"]] <- PercentageFeatureSet(srt, pattern = "^MT-") # this is for Homo sapiens. If the organism is Mus musculus, then: pattern = '^mt-'
# plot the number of features (or genes) per cell, the number of counts per cell and the percent.mt per cell
VlnPlot(srt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3) # As described in Seurat introductory Vignettes
# filter the Seurat object based on the violin plot
srt <- subset(srt, subset = nFeature_RNA > 1000 & nFeature_RNA < 6000 & nCount_RNA <25000 & percent.mt < 15) # Modify numbers appropriate to your violin plot
VlnPlot(srt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3) # As described in Seurat introductory Vignettes
vln <- VlnPlot(srt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3) # As described in Seurat introductory Vignettes
srt <- readRDS('input/sample1_Seurat_object.rds')
# define the percentage of counts per cell that originate from mitochondrial genes
srt[["percent.mt"]] <- PercentageFeatureSet(srt, pattern = "^MT-") # this is for Homo sapiens. If the organism is Mus musculus, then: pattern = '^mt-'
# plot the number of features (or genes) per cell, the number of counts per cell and the percent.mt per cell
VlnPlot(srt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3) # As described in Seurat introductory Vignettes
# filter the Seurat object based on the violin plot
srt <- subset(srt, subset = nFeature_RNA > 1000 & nFeature_RNA < 7500 & nCount_RNA <50000 & percent.mt < 15) # Modify numbers appropriate to your violin plot
snv_file <- 'input/sample1_SNVs.tsv'
rm(snv_file_path, rds_file_path)
